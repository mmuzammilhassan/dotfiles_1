#!/bin/bash

# Pick directory
#selected=$(find ~/projects/php/phpoop/ ~/projects/php/phpoop/gio ~/projects -maxdepth 3 -type d 2>/dev/null | fzf)
#selected=$(find ~/projects/php/phpoop/ -maxdepth 3 -type d 2>/dev/null | fzf)
selected=$(find ~/projects/php/phpoop/ -maxdepth 1 -type d 2>/dev/null | fzf)
[[ -z "$selected" ]] && exit 0

# Session name (no dots)
session=$(basename "$selected" | tr . _)

# If tmux server is NOT running at all
if ! tmux has-session 2>/dev/null; then
    tmux new-session -s "$session" -c "$selected"
    exit 0
fi

# If tmux is running but session doesn't exist
if ! tmux has-session -t "$session" 2>/dev/null; then
    tmux new-session -ds "$session" -c "$selected"
fi

# Switch to session
tmux switch-client -t "$session" 2>/dev/null || tmux attach -t "$session"

#✅ Workflow After This
#M-f → fuzzy find dir → it creates or switches to session.
#
#Inside session, do M-g → type h → now saved to M-h.
#
#Later, just do M-h → boom, you're back.
